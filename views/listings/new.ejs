<% layout("/layouts/boilerplate") %>

<div class="container mt-4">
  <h3>Create a New Listing</h3>

  <!-- Flash Messages -->
  <%- include("../includes/flash.ejs") %>

  <form method="POST" action="/listings" enctype="multipart/form-data" class="needs-validation" novalidate>
    <input type="hidden" name="_csrf" value="<%= csrfToken %>">

    <!-- Title -->
    <div class="mb-3">
      <label class="form-label">Title</label>
      <input name="listing[title]" type="text" class="form-control" required>
      <div class="invalid-feedback">Please provide a title.</div>
    </div>

    <!-- Description -->
    <div class="mb-3">
      <label class="form-label">Description</label>
      <textarea name="listing[description]" class="form-control" required></textarea>
      <div class="invalid-feedback">Please provide a description.</div>
    </div>

    <!-- Price -->
    <div class="mb-3">
      <label class="form-label">Price</label>
      <input name="listing[price]" type="number" class="form-control" required>
      <div class="invalid-feedback">Please enter a valid price.</div>
    </div>

    <!-- Location -->
    <div class="mb-3">
      <label class="form-label">Location</label>
      <input name="listing[location]" type="text" class="form-control" required>
      <div class="invalid-feedback">Please enter a location.</div>
    </div>

    <!-- Country -->
    <div class="mb-3">
      <label class="form-label">Country</label>
      <input name="listing[country]" type="text" class="form-control" required>
      <div class="invalid-feedback">Please enter a country.</div>
    </div>

    <!-- Category -->
    <div class="mb-3">
      <label class="form-label">Category</label>
      <select name="listing[category]" class="form-control" required>
        <option value="">-- Select category --</option>
        <% categories.forEach(cat => { %>
          <option value="<%= cat %>"><%= cat %></option>
        <% }) %>
      </select>
      <div class="invalid-feedback">Please select a category.</div>
    </div>

    <!-- Image -->
    <div class="mb-3">
      <label class="form-label">Upload Image</label>
      <input name="image" type="file" class="form-control">
    </div>

    <button type="submit" class="btn btn-primary w-100">Create Listing</button>
  </form>
</div>
